## 11.2.2 μ„λ²„μ»΄ν¬λ„νΈλ€?

: ν•λ‚μ μ–Έμ–΄, ν•λ‚μ ν”„λ μ„μ›ν¬, κ·Έλ¦¬κ³  ν•λ‚μ APIμ™€ κ°λ…μ„ μ‚¬μ©ν•λ©΄μ„ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ λ¨λ‘μ—μ„ μ»΄ν¬λ„νΈλ¥Ό λ λ”λ§ ν•  μ μλ” κΈ°λ²•μ„ μλ―Έν•λ‹¤.

> μ„λ²„μ—μ„ ν•  μ μλ” μΌμ€ μ„λ²„κ°€<br>
> μ„λ²„κ°€ ν•  μ μ—†λ” μΌμ€ ν΄λΌμ΄μ–ΈνΈμΈ λΈλΌμ°μ €μ—μ„ μν–‰

β‡’ μ¦‰, μΌλ¶€ μ»΄ν¬λ„νΈλ” ν΄λΌμ΄μ–ΈνΈμ—μ„, μΌλ¶€ μ»΄ν¬λ„νΈλ” μ„λ²„μ—μ„ λ λ”λ§ λλ” κ²ƒμ΄λ‹¤.

πΒ μ¤‘μ”ν• μ‚¬μ‹¤μ€ π

ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό importν•  μ μ—†λ‹¤λ” κ²ƒμ΄λ‹¤.

> λ§μ•½ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈκ°€ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό λ¶λ¬μ¤κ² λλ‹¤λ©΄, ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό μ‹¤ν–‰ν•  λ°©λ²•μ΄ μ—†κΈ° λ•λ¬Έμ—(μ„λ²„ν™κ²½μ΄ λΈλΌμ°μ €μ—λ” μ΅΄μ¬ν•μ§€ μ•λ”λ‹¤.) μ»΄ν¬λ„νΈλ¥Ό νΈμ¶ ν•  μ μ—†λ‹¤.

### Q. κ·Έλ¬λ©΄ μ–΄λ–»κ² λ¦¬μ•΅νΈ νΈλ¦¬ λ‚΄λ¶€μ μ»΄ν¬λ„νΈλ¥Ό μ„λ²„ μ»΄ν¬λ„νΈμ™€ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ κ°κ°μ„ λ§λ“¤μ–΄μ„ κ΄€λ¦¬ν•  μ μλ” κ²ƒμΌκΉ?

![](https://velog.velcdn.com/images/juhee067/post/13e4ab53-481b-4b3f-958f-9daa1376bea6/image.png)

μ„λ²„ μ»΄ν¬μ— λ”°λ¥΄λ©΄, λ¨λ“  μ»΄ν¬λ” μ„λ²„ μ»΄ν¬κ°€ λ  μλ„ μκ³ , ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬κ°€ λ  μλ„ μλ‹¤. μ΄κ² κ°€λ¥ ν• μ΄μ λ” childrenμΌλ΅ μμ£Ό μ‚¬μ©λλ” ReactNodeμ— μλ‹¤.

```jsx
//ClientComponent.jsx
"use client";
import ServerComponent from "./ServerComponent.server"; // 1) μ΄κ²ƒμ€ μ λ€ λ¶κ°€λ¥
export default function ClientComponent() {
  return (
    <div>
      <ServerComponent />
    </div>
  );
}

//ClientComponent.jsx
("use client");
export default function ClientComponent({ children }) {
  return (
    <div>
      <h1>ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ</h1>
      {children}
    </div>
  );
}

//ServerComponent.jsx
export default function ServerComponent() {
  return <span>ServerComponent</span>;
}

//ParentServerComponent.jsx
//μ„λ²„μ»΄ν¬λ„νΈμΌμλ„, ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμΌ μλ„ μλ‹¤.
import ClienntComponent from "./ClientComponent";
import ServerComponent from "./ServerComponent";

export default function ParentServerComponent() {
  return (
    <ClienntComponent>
      <ServerComponent />
    </ClienntComponent>
  );
}
```

μ„ μ½”λ“λ” μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό κΈ°λ°μΌλ΅ λ¦¬μ•΅νΈ μ»΄ν¬λ„νΈ μ„¤κ³„ν•  λ• μ–΄λ–¤ μ ν•μ΄ μλ”μ§€λ¥Ό μ•λ ¤μ¤€λ‹¤. μ λ³΄λ©΄ μ„λ²„μ»΄ν¬λ„νΈ, ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ, κ³µμ© μ»΄ν¬λ„νΈκ°€ μ΅΄μ¬ν•¨μ„ μ• μ μλ‹¤.

### μ„λ²„ μ»΄ν¬λ„νΈ

- μ”μ²­μ΄ μ¤λ©΄ μ„λ²„μ—μ„ λ”± ν• λ² μ‹¤ν–‰λ  λΏ, μƒνƒ μ•κ°€μ§„λ‹¤.
  - useState, useReducer λ“±μ hook μ‚¬μ© λ¶κ°€λ¥
- λ λ”λ§ μƒλ…μ£ΌκΈ°λ„ μ‚¬μ© λ»ν•λ‹¤.
  - λ”± ν•λ² μ‹¤ν–‰λλ‹κΉ β‡’ useEffect, useLayoutEffect μ‚¬μ© λ¶κ°€λ¥
- μ•μ λ‘κ°€μ§€ μ μ•½μΌλ΅ effectλ‚ stateμ— μμ΅΄ν•λ” ν›… λν• μ‚¬μ©μ΄ λ¶κ°€λ¥ν•λ‹¤
- λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λμ§€ μ•κ³  μ„λ²„μ—μ„λ§ μ‹¤ν–‰λκΈ° λ•λ¬Έμ— DOM APIλ¥Ό μ“±
  document, window μ ‘κ·Ό λ¶κ°€λ¥ν•λ‹¤.
- DB,λ‚΄λ¶€μ„λΉ„μ¤ λ“± μ„λ²„μ—λ§ μλ” λ°μ΄ν„°λ¥Ό async/awaitμΌλ΅ μ ‘κ·Όν•  μ μλ‹¤.
- λ‹¤λ¥Έ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό λ λ”λ§ν•κ±°λ‚ div,span, p κ°™μ€ μ”μ†λ¥Ό λ λ”λ§ν•κ±°λ‚ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό λ λ”λ§ν•  μ μλ‹¤.

### ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ

- λΈλΌμ°μ € ν™κ²½μ—μ„λ§ μ‹¤ν–‰λλ‹¤.
  - μ„λ²„ μ»΄ν¬λ„νΈ, μ„λ²„ μ „μ© ν›…μ΄λ‚ μ ν‹Έλ¦¬ν‹° λ¶λ¬μ¤κΈ° λ¶κ°€λ¥
- μ„λ²„ μ»΄ν¬λ„νΈκ°€ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό λ λ”λ§ν•λ”κ²½μ° ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈκ°€ μμ‹μΌλ΅ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό κ°–λ” κ²ƒμ€ κ°€λ¥ν•λ‹¤.
  - ν΄λΌμ΄μ–ΈνΈ μ…μ¥μ—μ„ μ„λ²„ μ»΄ν¬λ„νΈλ” μ΄λ―Έ μ„λ²„μ—μ„ λ§λ“¤μ–΄μ§„ νΈλ¦¬λ¥Ό κ°€μ§€κ³  μμ„ κ²ƒμ΄κ³ ,
    ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” μ΄λ―Έ μ„λ²„μ—μ„ λ§λ“¤μ–΄μ§„ κ·Έ νΈλ¦¬λ¥Ό μ‚½μ…ν•΄μ„ λ³΄μ—¬μ£ΌκΈ°λ§ ν•κΈ° λ•λ¬Έμ΄λ‹¤.
    κ·Έλ ‡κΈ° λ•λ¬Έμ— μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ¤‘μ²©ν•΄μ„ κ°–λ” μ„μ™€ κ°™μ€ κµ¬μ΅°λ΅ μ„¤κ³„κ°€ κ°€λ¥ν•λ‹¤.
- μ΄ λ‘κ°€μ§€ μμ™Έ μ‚¬ν•­μ„ μ μ™Έν•λ©΄ μΌλ°μ μΌλ΅ μ°λ¦¬κ°€ μ•κ³  μλ” λ¦¬μ•΅νΈ μ»΄ν¬λ„νΈμ™€ κ°™λ‹¤.

### κ³µμ© μ»΄ν¬λ„νΈ

- μ„λ²„&ν΄λΌμ΄μ–ΈνΈμ—μ„ λ¨λ‘ μ‚¬μ© κ°€λ¥ν•λ©° λ‘ μ»΄ν¬λ„νΈμ μ μ•½μ„ λ¨λ‘ λ°›λ”λ‹¤.

### Q. μ–΄λ–»κ² μ΄ μ„Έκ°€μ§€λ¥Ό νλ‹¨ν• κΉ?

κΈ°λ³Έμ μΌλ΅ λ¦¬μ•΅νΈλ” λ¨λ“  κ²ƒμ„ λ‹¤ κ³µμ© μ»΄ν¬λ„νΈλ΅ νλ‹¨ν•λ‹¤.

λ‹¤λ¥Έ λ§λ΅ λ¨λ“  μ»΄ν¬λ„νΈλ¥Ό μ„λ²„μ—μ„ μ‹¤ν–‰ κ°€λ¥ν• μ»΄ν¬λ„νΈλ΅ λ¶„λ¥ν•λ‹¤.

μ΄λ¥Ό ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ…μ‹μ  μ„ μ–Έμ„ ν•λ ¤λ©΄ "use client"λΌκ³  μ‘μ„±ν•΄λ‘λ©΄ λλ‹¤.

## 11.2.3 μ„λ²„ μ‚¬μ΄λ“λ λ”λ§κ³Ό μ„λ²„ μ»΄ν¬λ„νΈμ μ°¨μ΄

λ‘λ‹¤ λΉ„μ·ν• λ§ μ•„λ‹κ°€? μ λ€ μ•„λ‹

**[μ„λ²„ μ‚¬μ΄λ“ λ λ”λ§]**

μ‘λ‹µλ°›μ€ νμ΄μ§€ μ „μ²΄λ¥Ό HTMLλ΅ λ λ”λ§ ν•λ” κ³Όμ •μ„ μ„λ²„μ—μ„ μν–‰ ν›„ κ·Έ κ²°κ³Όλ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ‚΄λ ¤μ£Όκ³  ν΄λΌμ΄μ–ΈνΈμ—μ„ ν•μ΄λ“λ μ΄μ… κ³Όμ •μ„ κ±°μ³ μ΄λ²¤νΈλ¥Ό λ¶™μ΄λ” λ“±μ μ‘μ—…μ„ μν–‰ν•λ‹¤.

μ¦‰, μ—¬μ „ν μ΄κΈ° HTML λ΅λ”© μ΄ν›„μ—λ” ν΄λΌμ΄μ–ΈνΈμ—μ„ JSμ½”λ“λ¥Ό λ‹¤μ΄ν•κ³  νμ‹±ν•κ³  μ‹¤ν–‰ν•λ‹¤.

> ν•μ΄λ“λ μ΄μ…(hydration):
> ν΄λΌμ΄μ–ΈνΈ μΈ΅μ—μ„ μ„λ²„μ—μ„ λ°›μ€ HTMLμ„ κΈ°λ°μΌλ΅ JavaScriptλ¥Ό μ‹¤ν–‰ν•μ—¬ λ™μ μΌλ΅ κµ¬μ„±λ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ΄κΈ°ν™”ν•λ” κ³Όμ •

μ„λ²„ μ‚¬μ΄λ“ λ λ”λ§μ€ μ΄κΈ° λ λ”λ§μ„ κ°μ„ ν•λ” λ° μ¤‘μ μ„ λ‘κ³  μμΌλ©°, μ„λ²„ μ»΄ν¬λ„νΈλ” μ„λ²„ μΈ΅μ—μ„ μ‹¤ν–‰λλ” λ΅μ§μ„ κ΄€λ¦¬ν•κ³  μµμ ν™”ν•λ” λ° μ¤‘μ μ„ λ‘κ³  μλ‹¤.

μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό ν™μ©ν•μ—¬ μ„λ²„μ—μ„ λ λ”λ§ν•  μ μλ” μ»΄ν¬λ„νΈλ” μ„λ²„μ—μ„ μ κ³µλ°›κ³ , ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” μ„λ²„μ‚¬μ΄λ“ λ λ”λ§μ„ ν™μ©ν•μ—¬ μ΄κΈ° HTMLμ„ λ°›μ„ μ μλ‹¤.

λ‘ κ°λ…μ€ λ€μ²΄μ κ°€ μ•„λ‹ μƒνΈλ³΄μ™„ν•λ” κ°λ…μ΄ λ  μ μμμ„ μ•λ©΄ μΆ‹μ„ κ²ƒμ΄λ‹¤.

## 11.2.4 μ„λ²„ μ»΄ν¬λ„νΈλ” μ–΄λ–»κ² μ‘λ™ν•λ”κ°€?

λ¦¬μ•΅νΈ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό λ λ”λ§ ν•κΈ° μ„ν•΄ μΌμ–΄λ‚λ” μΌλ“¤μ„ κ°„λ‹¨ν•κ²λ§ μ‚΄ν΄ λ³΄μ.

**https://github.com/prisma/server-components-demo**

λ¦¬μ•΅νΈ ν€μ—μ„ 2021λ…„ κ³µμ‹μ μΌλ΅ μ κ³µν• λ ν¬λ¥Ό prismaμ—μ„ ν¬ν¬ν• μμ μ΄λ‹¤.

μ΄ μμ λ¥Ό μ‚¬μ©ν•λ©΄ ν•„μ”ν• DBμ„¤μΉ&μ„¤μ • μ‘μ—…μ„ κ±΄λ„λ›Έ μ μλ‹¤.

λ¦¬μ•΅νΈ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό λ‚ κ²ƒμΌλ΅ λ§›λ³΄κ³  μ‹¶λ‹¤λ©΄ μ΄ μ €μ¥μ†λ¥Ό μ°Έκ³ ν•μ.

[μ„λ²„ μ‚¬μ΄λ“ λ λ”λ§μ΄ μν–‰λμ§€ μ•λ” μ½”λ“]

```jsx
// server-components-demo/server/api.server.js

app.get(
  '/',
  handleErrors(async function (_req, res) {
    await waitForWebpack();
    const html = readFileSync(path.resolve(__dirname, '../build/index.html'), 'utf8');
    // Note: this is sending an empty HTML shell, like a client-side-only app.
    // However, the intended solution (which isn't built out yet) is to read
    // from the Server endpoint and turn its response into an HTML stream.
    res.send(html);
  })
);
```

- μ„λ²„μ‚¬μ΄λ“ λ λ”λ§μ΄ μν–‰λμ§€ μ•λ”λ‹¤.
- waitForWepack
  - λ‹¨μν κ°λ° ν™κ²½μ—μ„ μ›Ήν©μ΄ λΉλ“ κ²½λ΅μ— index.htmlμ„ λ§λ“¤ λ•κΉμ§€ κΈ°λ‹¤λ¦¬λ” μ½”λ“
- μ‚¬μ©μκ°€ μµμ΄ μ§„μ… μ‹ index.htmlμ„ μ κ³µν•λ” μ—­ν• λ§ ν•κ³  μλ‹¤.

1. μ„λ²„κ°€ λ λ”λ§ μ”μ²­μ„ λ°›λ”λ‹¤.
   μ„λ²„κ°€ λ λ”λ§ κ³Όμ •μ„ μν–‰ν•΄μ•Όν•κΈ°μ— μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό μ‚¬μ©ν•λ” λ¨λ“  νμ΄μ§€λ” ν•­μƒ μ„λ²„μ—μ„ μ‹μ‘λλ‹¤.
   - μ¦‰ λ£¨νΈμ— μλ” μ»΄ν¬λ„νΈλ” ν•­μƒ μ„λ²„ μ»΄ν¬λ„νΈλ‹¤. μμ μ κµ¬μ΅°λ” μ•„λμ™€ κ°™λ‹¤.

![](https://velog.velcdn.com/images/juhee067/post/d006710c-2075-4619-9f8d-26b41777a1af/image.png)

μ΄ μμ μ—μ„ /react λΌκ³  ν•λ” μ£Όμ†λ΅ μ”μ²­μ„ λ³΄λ‚΄λ©΄ μ„λ²„λ” λΈλΌμ°μ €μ μ”μ²­μ„ λ°›κ³  μ„λ²„ λ λ”λ§μ„ μ‹μ‘

2. μ„λ²„λ” λ°›μ€ μ”μ²­μ— λ”°λΌ μ»΄ν¬λ„νΈλ¥Ό JSONμΌλ΅ μ§λ ¬ν™”ν•λ‹¤.
   μ„λ²„μ—μ„ λ λ”λ§ν•  μ μλ” λ¶€λ¶„μ€ μ§λ ¬ν™”ν•κ³  ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ ν‘μ‹λ λ¶€λ¶„μ€ ν•΄λ‹Ή κ³µκ°„μ„ ν”λ μ΄μ¤ν™€λ” ν•μ‹μΌλ΅ λΉ„μ›λ‘”λ‹¤. λΈλΌμ°μ €λ” μ΄ν›„μ— μ΄ κ²°κ³Όλ¬Όμ„ λ°›μ•„μ„ λ‹¤μ‹ μ—­μ§λ ¬ν™”ν• λ‹¤μ λ λ”λ§μ„ μν–‰ν•λ‹¤.
3. λΈλΌμ°μ €κ°€ λ¦¬μ•΅νΈ μ»΄ν¬λ„νΈ νΈλ¦¬λ¥Ό κµ¬μ„±ν•λ‹¤. λΈλΌμ°μ €κ°€ μ„λ²„λ΅ μ¤νΈλ¦¬λ°μΌλ΅ λ°›μ€ JSON κµ¬λ¬Έμ„ λ‹¤μ‹ νμ‹±ν•μ—¬ νΈλ¦¬λ¥Ό μ¬κµ¬μ„±ν•λ‹¤. ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό λ°›μ•λ‹¤λ©΄ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ λ”λ§μ„ μ§„ν–‰ν•κ³  μ„λ²„μ—μ„ λ§λ“¤μ–΄μ§„ κ²°κ³Όλ¬Όμ„ λ°›μ•λ‹¤λ©΄ μ΄λ¥Ό κΈ°λ°μΌλ΅ λ¦¬μ•΅νΈ νΈλ¦¬λ¥Ό κ·Έλ€λ΅ λ§λ“ λ‹¤.

> κ·Έλ ‡κ² μµμΆ…μ μΌλ΅ μ΄ νΈλ¦¬λ¥Ό λ λ”λ§ν•΄ λΈλΌμ°μ €μ DOMμ— μ»¤λ°‹ν•λ‹¤.

[λ¦¬μ•΅νΈ μ„λ²„ μ»΄ν¬λ„νΈμ μ‘λ™ λ°©μ‹μ νΉλ³„ν• μ ]

> λ¦¬μ•΅νΈ μ„λ²„ μ»΄ν¬λ„νΈλ” μ •λ³΄λ¥Ό μ¤νΈλ¦¬λ°ν•μ—¬ ν΄λΌμ΄μ–ΈνΈκ°€ λΉ λ¥΄κ² κ²°κ³Όλ¬Όμ„ λ°›μ„ μ μλ„λ΅ ν•λ©°, μ»΄ν¬λ„νΈλ“¤μ΄ λ³„λ„λ΅ λ²λ“¤λ§λμ–΄ ν•„μ”μ— λ”°λΌ λ”°λ΅ λ°›κ±°λ‚ μ§€μ—°ν•΄μ„ λ°›μ„ μ μλ‹¤. μ΄λ¥Ό ν†µν•΄ μ΄κΈ° λ λ”λ§μ„ μµμ ν™”ν•  μ μλ‹¤.

κ²°λ΅ μ μΌλ΅ μ΄ λ¦¬μ•΅νΈ μ„λ²„ μ»΄ν¬λ„νΈλ” μ™„μ „ν μƒλ΅­κ² λ‚μ¨ κ°λ…μ΄λ©° κΈ°μ΅΄ λ¦¬μ•΅νΈ μ»΄ν¬λ„νΈκ°€ κ°€μ§€κ³  μλ ν•κ³„λ¥Ό κ·Ήλ³µν•κΈ° μ„ν•΄ λ‚μ™”λ‹¤.

# 11.3 Next.jsμ—μ„μ λ¦¬μ•΅νΈ μ„λ²„ μ»΄ν¬λ„νΈ

- Next.jsλ„ 13λ²„μ „μ— λ“¤μ–΄κ°€λ©° μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό λ„μ…ν•μ€κ³  μ΄ μ„λ²„μ»΄ν¬λ„νΈλ” /app λ””λ ‰ν† λ¦¬μ— κµ¬ν„λμ–΄ μλ‹¤.
- μ„λ²„μ»΄ν¬λ„νΈμ μ μ•½ μμ²΄λ” λ™μΌν•λ‹¤.
  - μ„λ²„ μ»΄ν¬λ„νΈλ” ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό λ¶λ¬μ¬ μ μ—†λ‹¤.
  - μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό children propsλ΅λ§ λ°›μ„ μ μλ‹¤.

μ•μ„ λ£¨νΈ μ»΄ν¬λ„νΈλ” λ¬΄μ΅°κ±΄ μ„λ²„ μ»΄ν¬λ„νΈκ°€ λλ‹¤κ³  μ–ΈκΈ‰ν–λ‹¤.

> Next.jsμ λ£¨νΈ μ»΄ν¬λ„νΈλ” κ° νμ΄μ§€μ— μ΅΄μ¬ν•λ” page.jsλ‹¤. κ·Έλ¦¬κ³  layout.jsλ„ λ§μ°¬κ°€μ§€λ΅ μ„λ²„μ»΄ν¬λ„νΈλ΅ μ‘λ™ν•λ‹¤. μ¦‰ page.jsμ™€ layout.jsλ” λ°λ“μ‹ μ„λ²„ μ»΄ν¬λ„νΈμ—¬μ•Όν•λ‹¤.

λ¦¬μ•΅νΈ μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ μ κ³µν•λ” λ‚΄μ©κ³Ό λ³„λ° μ°¨μ΄λ” μ—†μ§€λ§, Next.jsμ—μ„ μ„λ²„μ»΄ν¬λ„νΈλ¥Ό λ„μ…ν•λ©° μƒκΈ΄ λ‡κ°€μ§€ λ³€ν™”κ°€ μλ‹¤.

## 11.3.1 μƒλ΅μ΄ fetch λ„μ…κ³Ό getServerSideProps, getStaticProps, getIntial Propsμ μ‚­μ 

μ λ© μ²λΌ 3κ°€μ§€κ°€ μ‚­μ  λ λ€μ‹  λ¨λ“  λ°μ΄ν„° μ”μ²­μ€ μ›Ήμ—μ„ μ κ³µν•λ” ν‘μ¤€ APIμΈ fetchλ¥Ό κΈ°λ°μΌλ΅ μ΄λ¤„μ§„λ‹¤.

```jsx
async function getData() {
  //λ°μ΄ν„° λ¶λ¬μ¤κΈ°

  const result = await fetch('https://api.example.com');

  if (!result.ok) {
    //μ—λ¬κ°€ λμ Έμ§€λ©΄ κ°€μ¥ κ°€κΉμ΄ μ—λ¬ λ°”μ΄λ”λ¦¬λ΅ μ „λ‹¬
    throw new Error('μ‹¤ν¨');
  }

  return result.json();
}

//async μ„λ²„ μ»΄ν¬λ„νΈ νμ΄μ§€
export default async function Page() {
  const data = await getData();

  return (
    <main>
      <Children data={data}></Children>
    </main>
  );
}
```

- getServerSidePropsλ” SSRλ§μ„ μ„ν• κ²ƒμ΄μ—μΌλ―€λ΅ μ΄μ  μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό μ§μ ‘ λ¶λ¬μ¬ μ μκ² λλ‹¤.
- λν• μ»΄ν¬λ„νΈκ°€ λΉ„λ™κΈ°μ μΌλ΅ μ‘λ™ν•λ” κ²ƒλ„ κ°€λ¥ν•΄μ§„λ‹¤.
- μ΄μ  μ•μ μ„λ²„ μ»΄ν¬λ„νΈλ” λ°μ΄ν„°κ°€ λ¶λ¬μ¤κΈ° μ „κΉμ§€ κΈ°λ‹¤λ Έλ‹¤κ°€ λ°μ΄ν„°κ°€ λ¶λ¬μ™€μ§€λ©΄ λΉ„λ΅μ† νμ΄μ§€κ°€ λ λ”λ§λμ–΄ ν΄λΌμ΄μ–ΈνΈλ΅ μ „λ‹¬λ  κ²ƒμ΄λ‹¤.

> 2023λ…„ 5μ›” κΈ°μ¤€μΌλ΅λ” TSκ°€ λΉ„λ™κΈ° μ»΄ν¬λ„νΈλ¥Ό μ •μ‹μΌλ΅ μ§€μ›ν•μ§€ μ•λ”λ‹¤.

![](https://velog.velcdn.com/images/juhee067/post/02855ccb-3564-4804-b585-f1a2c98c4ed2/image.png)

μ΄μ— μ¶”κ°€λ΅ ν•΄λ‹Ή fetch μ”μ²­μ— λ€ν• λ‚΄μ©μ„ μ„λ²„μ—μ„ λ λ”λ§μ΄ ν•λ² λλ‚ λ•κΉμ§€ μΊμ‹±ν•λ©° ν΄λΌμ΄μ–ΈνΈμ—μ„λ” λ³„λ„ μ§€μ‹μλ‚ μ”μ²­μ΄ μ—†λ” μ΄μƒ ν•΄λ‹Ή λ°μ΄ν„°λ¥Ό μµλ€ν• μΊμ‹±ν•μ—¬ μ¤‘λ³µλ μ”μ²­μ„ λ°©μ§€ν•λ‹¤.

## 11.3.2 μ •μ λ λ”λ§κ³Ό λ™μ  λ λ”λ§

κ³Όκ±°μ—λ” Next.jsμ—μ„ getStaticPropsλ¥Ό μ‚¬μ©ν•μ—¬ μ •μ  λ λ”λ§μ„ μν–‰ν•μ—¬ CDNμ—μ„ μΊμ‹±ν•μ—¬ λΉ λ¥΄κ² λ°μ΄ν„°λ¥Ό μ κ³µν–λ‹¤. κ·Έλ¬λ‚ 13λ²„μ „μ—μ„λ” μ •μ  λΌμ°ν…μ— λ€ν•΄ κΈ°λ³Έμ μΌλ΅ λΉλ“ νƒ€μ„μ— λ λ”λ§ν•μ—¬ μΊμ‹±ν•μ—¬ μ¬μ‚¬μ©ν•κ³ , λ™μ  λΌμ°ν…μ— λ€ν•΄μ„λ” μ„λ²„μ— μ”μ²­μ΄ μ¬ λ•λ§λ‹¤ μ»΄ν¬λ„νΈλ¥Ό λ λ”λ§ν•λ„λ΅ λ³€κ²½λμ—λ‹¤.

[νΉμ • API μ—”λ“ ν¬μΈνΈμ—μ„ λ°μ΄ν„°λ¥Ό λ¶λ¬μ™€ νμ΄μ§€μ—μ„ λ λ”λ§ν•λ” κµ¬μ΅°λ¥Ό κ°€μ§„ μ„λ²„ μ»΄ν¬λ„νΈ]

```jsx
// Nest.js app/Page.tsx

async function fetchData() {
  const res = await fetch(`https://jsonplaceholder.typicode.com/posts`);
  const data = await res.json();
  return data;
}

export default async function Page() {
  const data: Array<any> = await fetchData();

  return (
    <ul>
      {data.map((item, key) => (
        <li key={key}>{item.id}</li>
      ))}
    </ul>
  );
}
```

μ΄ μ£Όμ†λ” μ •μ μΌλ΅ κ²°μ •λΌ μκΈ° λ•λ¬Έμ— λΉλ“ μ‹μ— ν•΄λ‹Ή μ£Όμ†λ΅ λ―Έλ¦¬ μ”μ²­ν•΄μ„ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¨ λ‹¤μ λ λ”λ§ν• κ²°κ³Όλ¥Ό λΉλ“μ— λ„£μ–΄λ‘”λ‹¤.

[μ•μ μ½”λ“λ¥Ό λΉλ“ν• κ²°κ³Όλ¬Όμ„ .nextμ—μ„ ν™•μΈν• λ¨μµ]

![](https://velog.velcdn.com/images/juhee067/post/60560363-f285-4e2f-8ea8-cdd2b40cd137/image.png)

λ―Έλ¦¬ μ κ³µν•κΈ° μ„ν• test.htmlμ΄ ν•΄λ‹Ή apiμ κ²°κ³Όλ¬Όκ³Ό ν•¨κ» μƒμ„±λΌ μλ” κ²ƒμ„ λ³Ό μ μλ‹¤.

ν•΄λ‹Ή μ£Όμ†λ¥Ό μ •μ μΌλ΅ μΊμ‹±ν•μ§€ μ•λ” λ°©λ²•λ„ μλ‹¤.

```jsx
async function fetchData() {
  const res = await fetch(`https://jsonplaceholder.typicode.com/posts`, {
    cache: 'no-cache', //μΊμ‹ν•μ§€ μ•μ
  });
  const data = await res.json();
  return data;
}

export default async function Page() {
  const data: Array<any> = await fetchData();

  return (
    <ul>
      {data.map((item, key) => (
        <li key={key}>{item.id}</li>
      ))}
    </ul>
  );
}
```

μΊμ‹±ν•μ§€ μ•κ² λ‹¤λ” μ„ μ–Έμ„ fetchμ— ν•΄λ‘λ©΄ Next.jsλ” ν•΄λ‹Ή μ”μ²­μ„ λ―Έλ¦¬ λΉλ“ν•΄μ„ λ€κΈ°μ‹μΌμ£Όμ§€ μ•κ³  μ”μ²­μ΄ μ¬λ•λ§λ‹¤ fetch μ”μ²­ ν›„μ— λ λ”λ§μ„ μν–‰ν•κ² λλ‹¤.

λ§μ•½ λ™μ μΈ μ£Όμ†μ΄μ§€λ§ νΉμ • μ£Όμ†μ— λ€ν•΄μ„ μΊμ‹±ν•κ³  μ‹¶μ€ κ²½μ°,

β‡’ μ¦‰ κ³Όκ±° Next.jsμ—μ„ μ κ³µν•λ” getStaticPathsλ¥Ό ν‰λ‚΄ λ‚΄κ³  μ‹¶λ‹¤λ©΄ μ–΄λ–»κ² ν•΄μ•Όν• κΉ?

: μƒλ΅μ΄ ν•¨μμΈ generateStaticParamsλ¥Ό μ‚¬μ©ν•λ©΄ λλ‹¤.

![](https://velog.velcdn.com/images/juhee067/post/70066930-b83d-4436-afc1-a9b511819aa0/image.png)

λΉλ“κ°€ λλ‚ λ’¤ ν΄λ”λ¥Ό ν™•μΈν•΄ λ³΄λ©΄ λ―Έλ¦¬ HTML κ²°κ³Όλ¬Όμ„ λ§λ“¤μ–΄ λ‘” κ²ƒμ„ μ• μ μλ‹¤.

μ΄λ¬ν• λ°©μ‹μΌλ΅ κΈ°μ΅΄ getStaticPropsμ μ‘λ™ λ°©μ‹μ„ κ·Έλ€λ΅ ν‰λ‚΄ λ‚΄μ–΄ μ›ν•λ” λ°©μ‹μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.

## 11.3.3 μΊμ‹μ™€ muatating κ·Έλ¦¬κ³  revalidating

Next.jsλ” fetchμ κΈ°λ³Έ μ‘λ™μ„ μ¬μ •μν•΄

```jsx
 {next: {revalidate?: number | false}}
```

μ κ³µν•λ”λ°, μ΄λ¥Ό λ°”νƒ•μΌλ΅ ν•΄λ‹Ή λ°μ΄ν„°μ μ ν¨μ‹κ°„μ„ μ •ν•΄λ‘κ³  μ‹κ°„μ΄ μ§€λ‚λ©΄ νμ΄μ§€λ¥Ό λ λ”λ§ ν•λ” κ²ƒμ΄λ‹¤.

```jsx
//app/page.tsx

export const revalidate = 60;
```

νμ΄μ§€μ— revalidateλΌλ” λ³€μλ¥Ό μ„ μ–Έν•΄μ„ νμ΄μ§€ λ λ²¨λ΅ μ •μλ„ κ°€λ¥

λ§μ•½ λ£¨νΈμ— μ΄μ²λΌ μ„ μ–Έν•΄λ‘λ©΄ ν•μ„μ— μλ” λ¨λ“  λΌμ°ν…μ—μ„λ” νμ΄μ§€λ¥Ό 60μ΄μ΄ κ°„κ²©μΌλ΅ κ°±μ‹ ν•΄ μƒλ΅ λ λ”λ§ν•κ²λλ‹¤. κ·Έλ¦¬κ³  μ•μ„  μμ μ²λΌ fetch λ‚΄λ¶€μ— μµμ…μΌλ΅ μ κ³µν•λ” κ²ƒλ„ κ°€λ¥ν•λ‹¤.

μ΄ μΊμ‹μ™€ κ°±μ‹ μ΄ μ΄λ¤„μ§€λ” κ³Όμ •μ€ λ‹¤μκ³Ό κ°™λ‹¤.

1. μµμ΄λ΅ λΌμ°νΈλ΅ μ”μ²­μ΄ μ¤λ” κ²½μ° μ •μ μΌλ΅ μΊμ‹ν•΄λ‘” λ°μ΄ν„° ν‘μ‹
2. μΊμ‹λ μ”μ²­μ€ revalidate μ„ μ–Έλ κ°’λ§νΌ μ μ§€
3. μ‹κ°„μ΄ μ§€λ‚λ„ μΌλ‹¨μ€ μΊμ‹λ λ°μ΄ν„° ν‘μ‹
4. Next.jsλ” μΊμ‹λ λ°μ΄ν„°λ¥Ό λ³΄μ—¬μ£Όλ©΄μ„ λ°±κ·ΈλΌμ΄λ“μ—μ„ λ‹¤μ‹ λ°μ΄ν„°λ¥Ό λ¶λ¬μ΄
5. 4λ² μ‘μ—…μ΄ λλ‚λ©΄ μΊμ‹λ λ°μ΄ν„°λ¥Ό κ°±μ‹ 

λ§μ•½ μ΄λ¬ν• μΊμ‹λ¥Ό μ „μ²΄μ μΌλ΅ λ¬΄ν¨ν™”ν•κ³  μ‹¶λ‹¤?

> routerμ— μ¶”κ°€λ refresh λ©”μ„λ“λ΅ router.refresh();λ¥Ό μ‚¬μ©ν•λ©΄λλ‹¤.

## 11.3.4 μ¤νΈλ¦¬λ°μ„ ν™μ©ν• μ μ§„μ μΈ νμ΄μ§€ λ¶λ¬μ¤κΈ°

κ³Όκ±°μ—λ” μ„λ²„ μ‚¬μ΄λ“ λ λ”λ§μ„ μ‚¬μ©ν•  λ•, μ‚¬μ©μλ” νμ΄μ§€κ°€ μ™„μ „ν λ λ”λ§λ  λ•κΉμ§€ μ•„λ¬΄κ²ƒλ„ λ³Ό μ μ—†μ—κ³ , λ λ”λ§μ΄ μ™„λ£λ ν›„μ—λ„ μ‚¬μ©μλ” μΈν„°λ™μ…μ„ ν•  μ μ—†λ” νμ΄μ§€λ¥Ό λ³Ό μλ°–μ— μ—†μ—λ‹¤.

μ΄λ¬ν• λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ HTMLμ„ μ΅°κ°μΌλ΅ λ‚λ μ„ μ μ§„μ μΌλ΅ ν΄λΌμ΄μ–ΈνΈλ΅ λ³΄λ‚΄λ” μ¤νΈλ¦¬λ° λ°©μ‹μ΄ λ„μ…λμ—λ‹¤. μ΄λ¥Ό ν†µν•΄ μ‚¬μ©μλ” νμ΄μ§€κ°€ μ™„μ „ν λ΅λ“λκΈ°λ¥Ό κΈ°λ‹¤λ¦¬μ§€ μ•κ³ λ„ μΌλ¶€λ¶„μ΄λΌλ„ νμ΄μ§€μ™€ μƒνΈ μ‘μ©ν•  μ μκ² λμ—λ‹¤.

λ‚μ•„κ°€ ν•µμ‹¬ μ›Ή μ§€ν‘μΈ μµμ΄ λ°”μ΄νΈκΉμ§€μ μ‹κ°„κ³Ό μµμ΄ μ½ν…μΈ ν’€ νμΈν…μ„ κ°μ„ ν•λ”λ° ν° λ„μ›€μ„ μ¤€λ‹¤.

![](https://velog.velcdn.com/images/juhee067/post/c342d3ce-30ca-4465-8e0c-2cd011334060/image.png)

λ¨λ“  μ»΄ν¬λ„νΈλ¥Ό κΈ°λ‹¤λ¦¬λ”κ²ƒμ΄ μ•„λ‹, μ»΄ν¬λ„νΈκ°€ μ™„μ„±λλ” λ€λ΅ ν΄λΌμ΄μ–ΈνΈμ—κ² λ‚΄λ ¤μ£Όλ©΄ μ‚¬μ©μλ” νμ΄μ§€κ°€ λ΅λ”©μ¤‘μ΄λΌλ” μΈμ‹μ„ λ” λ…ν™•ν•κ² μ‹¬μ–΄μ§ μ μλ‹¤.

μ΄ μ¤νΈλ¦¬λ°μ„ ν™μ©ν•  μ μλ” λ°©λ²• λ‘κ°€μ§€

1. κ²½λ΅μ— loading.ts λ°°μΉ : λ λ”λ§μ΄ μ™„λ£λκΈ° μ „μ— λ³΄μ—¬μ¤„ μ μλ” μ»΄ν¬λ„νΈλ¥Ό λ°°μΉν•  μ μλ” νμΌμ΄λ‹¤.
   μ΄ νμΌμ„ λ°°μΉν•λ‹¤λ©΄ μλ™μΌλ΅ suspenseκ°€ λ°°μΉλλ‹¤.
2. suspense λ°°μΉ : μΆ€ λ” μ„Έλ¶„ν™”λ μ μ–΄λ¥Ό ν•κ³  μ‹¶λ‹¤λ©΄ μ§μ ‘ λ¦¬μ•΅νΈμ suspenseλ¥Ό λ°°μΉν•λ” κ²ƒλ„ κ°€λ¥ν•λ‹¤.
