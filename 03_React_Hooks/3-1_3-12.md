# 3.1.3 useMemo

> `useMemo`ëŠ” ë¹„ìš©ì´ í° ì—°ì‚°ì˜ ê²°ê³¼ë¥¼ ì €ì¥(ë©”ëª¨ë¦¬ì œì´ì…˜)í•´ë‘ê³  ì´ ì €ì¥ëœ ê°’ì„ ë°˜í™˜í•˜ëŠ” í›…ì´ë©°, ìµœì í™”ë¥¼ ë– ì˜¬ë¦´ ë•Œ ê°€ì¥ ë¨¼ì € ì–¸ê¸‰ë˜ëŠ” í›…ì´ ë°”ë¡œ `useMemo`ì´ë‹¤.

## 1. ê¸°ë³¸ êµ¬ì¡°

![](https://velog.velcdn.com/images/juhee067/post/961b4dc9-601b-44d4-b157-a734d866432b/image.png)

```javascript
const memoizedValue = useMemo(() => expensiveComputation(a, b), [a, b]);
```

**1ï¸âƒ£ ì²« ë²ˆì§¸ ì¸ìˆ˜** : ì–´ë– í•œ ê°’ì„ ë°˜í™˜í•˜ëŠ” ìƒì„± í•¨ìˆ˜
**2ï¸âƒ£ ë‘ ë²ˆì§¸ ì¸ìˆ˜** : í•´ë‹¹ í•¨ìˆ˜ê°€ ì˜ì¡´í•˜ëŠ” ê°’ì˜ ë°°ì—´

**useMemoëŠ” ë Œë”ë§ ë°œìƒ ì‹œ**
ì˜ì¡´ì„± ë°°ì—´ì˜ ê°’ì´
ë³€ê²½âŒ => í•¨ìˆ˜ë¥¼ ì¬ì‹¤í–‰ í•˜ì§€ì•Šê³ , ì´ì „ì— ê¸°ì–µí•´ ë‘” í•´ë‹¹ê°’ì„ ë°˜í™˜í•œë‹¤.
ë³€ê²½â­• =>ì²« ë²ˆì§¸ ì¸ìˆ˜ì˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ í›„ì—, ê·¸ ê°’ì„ ë°˜í™˜í•˜ê³  ê·¸ ê°’ì„ ë‹¤ì‹œ ê¸°ì–µí•œë‹¤.

> ì´ëŸ¬í•œ ë©”ëª¨ì´ì œì´ì…˜ì€ ë‹¨ìˆœíˆ ê°’ë¿ë§Œ ì•„ë‹ˆë¼ ì»´í¬ë„ŒíŠ¸ë„ ê°€ëŠ¥í•˜ë‹¤.

```javascript
// useMemoë¥¼ ì‚¬ìš©í•œ ì»´í¬ë„ŒíŠ¸ ë©”ëª¨ì´ì œì´ì…˜
function ExpensiveComponent({ value }) {
  useEffect(() => {
    console.log('ë Œë”ë§ ì¤‘!');
  }, []); // ë Œë”ë§ë  ë•Œë§ˆë‹¤ ì½˜ì†”ì— 'ë Œë”ë§ ì¤‘!' ì¶œë ¥

  return <span>{value + 1000}</span>;
}

function App() {
  const [value, setValue] = useState(10);
  // â‘¡ triggerRenderingìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ì„ ê°•ì œë¡œ ë°œìƒ
  const [, triggerRendering] = useState(false);

  // ì»´í¬ë„ŒíŠ¸ì˜ propsë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ìì²´ë¥¼ ë©”ëª¨ì´ì œì´ì…˜
  // â‘  usememoë¡œ ì»´í¬ë„ŒíŠ¸ë„ ê°ìŒ€ ìˆ˜ ìˆë‹¤. ë¬¼ë¡  react.memoë¥¼ ì“°ëŠ” ê²ƒì´ ë” í˜„ëª…í•˜ë‹¤.
  const MemoizedComponent = useMemo(() => <ExpensiveComponent value={value} />, [value]);

  // input ê°’ ë³€ê²½ í•¸ë“¤ëŸ¬
  function handleChange(e) {
    setValue(Number(e.target.value));
  }

  // ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬
  function handleClick() {
    triggerRendering((prev) => !prev); // triggerRendering ìƒíƒœë¥¼ í† ê¸€
  }

  return (
    <>
      <input value={value} onChange={handleChange} />
      <button onClick={handleClick}>ë Œë”ë§ ë°œìƒ!</button>
      {MemoizedComponent}
    </>
  );
}
```

â‘¡ triggerRenderingìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ì„ ê°•ì œë¡œ ë°œìƒì‹œì¼°ì§€ë§Œ memoizedComponentëŠ” ë¦¬ë Œë”ë§ë˜ì§€ì•ŠìŒâŒ

### **âœ” Q1. ì™œ ë¦¬ë Œë”ë§ì´ ì•ˆë˜ëŠ”ê°€?**

> useMemo í›…ì— ì „ë‹¬ëœ ì˜ì¡´ì„± ë°°ì—´ì´ **[value]ë¡œ** ì„¤ì •ë˜ì–´ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
> ì´ ì˜ì¡´ì„± ë°°ì—´ì€ MemoizedComponentê°€ **ë‹¤ì‹œ ë Œë”ë§ë˜ëŠ” ì¡°ê±´**ì„ ê²°ì •í•˜ëŠ”ë°,
> ë°°ì—´ ë‚´ì˜ ìš”ì†Œê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ MemoizedComponentëŠ” ì´ì „ì— ìƒì„±ëœ ê°’ì„ ì¬ì‚¬ìš©í•©ë‹ˆë‹¤.

ğŸ”… ì¥ì  :
1ï¸âƒ£ **ë¬´ê±°ìš´ ì—°ì‚°**ì„ ë‹¤ì‹œ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ ë§‰ì„ ìˆ˜ ìˆë‹¤
2ï¸âƒ£ ì–´ë–¤ ê°’ì„ ê³„ì‚°í•  ë•Œ í•´ë‹¹ ê°’ì„ ì—°ì‚°í•˜ëŠ” ë° ë¹„ìš©ì´ ë§ì´ ë“ ë‹¤ë©´ ì‚¬ìš©í•˜ê¸° ì¢‹ë‹¤.

ì—¬ê¸°ì„œ ë§í•˜ëŠ” **ë¹„ìš©ì´ ë§ì´ ë“œëŠ” ì—°ì‚°**ì´ë€?

> ì»´í“¨í„°ê°€ ë§ì€ ì‹œê°„ê³¼ ìì›ì„ ì†Œëª¨í•˜ì—¬ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì‘ì—…

### **âœ” Q2. ê·¸ëŸ¼ ë¬´ì‘ì • `useMemo`ë¥¼ ë‹¤ì“°ëŠ” ê²ƒì´ ì¢‹ì€ ê²ƒì¸ê°€? âŒ**

1ï¸âƒ£ ëª¨ë“  ê°’ì— useMemoë¥¼ ì ìš©í•˜ë©´ ì½”ë“œê°€ ë” ì–´ë ¤ì›Œì§ˆ ìˆ˜ ìˆê³ , ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›€
2ï¸âƒ£ useMemoëŠ” ê°’ì´ ë³€í•˜ì§€ ì•ŠëŠ” í•œ ê³„ì‚° ê²°ê³¼ë¥¼ ìºì‹œí•˜ì—¬ ì¬ì‚¬ìš©í•˜ê¸°ì— ê°’ì´ ìì£¼ ë³€ê²½ë˜ëŠ” ê²½ìš°ì—ëŠ” ì´ëŸ¬í•œ ìºì‹±ì´ ì˜¤íˆë ¤ ìì›ì„ ë‚­ë¹„í•œë‹¤.
3ï¸âƒ£ì‘ì—…ì´ ë§¤ìš° ê°„ë‹¨í•˜ê³  ë¹ ë¥´ê²Œ ìˆ˜í–‰ë˜ëŠ” ê²½ìš°ì—ëŠ” useMemoë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ë‹¤.

# 3.1.4 useCallback

> `useMemo`ê°€ **ê°’**ì„ ê¸°ì–µí•œë‹¤ë©´, `useCallback`ì€ ì¸ìˆ˜ë¡œ ë„˜ê²¨ë°›ì€ **ì½œë°± ìì²´**ë¥¼ ê¸°ì–µí•œë‹¤. ì¦‰, íŠ¹ì • í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ë§Œë“¤ì§€ ì•Šê³  ì¬ì‚¬ìš©í•˜ê²Œ ëœë‹¤.

![](https://velog.velcdn.com/images/juhee067/post/9945bf3e-2aa1-4a58-addd-246c141f5687/image.png)

[ **memoë¥¼ ì‚¬ìš©í•¨ì—ë„ ì „ì²´ ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë˜ëŠ” ì˜ˆì œ** ]

```jsx
const ChildComponent = memo(({ name , value , onChange})) => {
// ë Œë”ë§ ìˆ˜í–‰ í™•ì¸ìš©
    useEffect(() => {
        console.log('ë Œë”ë§!',name)
    })

    return (
        <>
          <h1>{name} {value ? 'ì¼œì§' ? 'êº¼ì§'}</h1>
          <button onClick = {onChange}>toggle</button>
        </>
    )
}

function App() {
    const [state1,setState1] = useState(false)
    const [state2,setState2] = useState(false)

    const toggle1 = () => {
        setState1(!state1)
    }

    const toggle2 = () => {
        setState2(!state2)
    }

    return (
        <>
          <ChildComponent name = "1" value = {state1} onChange = {toggle1} />
          <ChildComponent name = "2" value = {state2} onChange = {toggle2} />
        </>
    )
}

```

âœ… memoë¥¼ ì‚¬ìš©í•´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë©”ëª¨ì´ì œì´ì…˜í–ˆì§€ë§Œ App ìì‹ ì»´í¬ë„ŒíŠ¸ ì „ì²´ê°€ ë Œë”ë§ ë˜ê³  ìˆë‹¤.

â–¶ ChildComponentì˜ memoë¥¼ ì”Œìš°ë©´ name,value,onChangeì˜ ê°’ì„ ëª¨ë‘ ê¸°ì–µí•˜ê³  ,
ì´ ê°’ë“¤ì´ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ ë‹¤ì‹œ ë Œë”ë§ ë˜ì§€ ì•ŠëŠ”ë‹¤.

ë²„íŠ¼ì„ ëˆ„ë¥´ê²Œ ëœë‹¤ë©´ â¡ ì´ ë²„íŠ¼ì´ setStateì„ í˜¸ì¶œí•˜ê³  â¡ stateê°’ì´ ë°”ë€Œê³  â¡ Appì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ì‹œ ë Œë”ë§ë˜ê³  â¡ ê·¸ë•Œë§ˆë‹¤ onChangeí•¨ìˆ˜ê°€ ì¬ìƒì„±ëœë‹¤.
**ë”°ë¼ì„œ ì˜ë„í•œ ëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šê²Œ ëœë‹¤â‰** : í´ë¦­ í•  ë•Œë§ˆë‹¤ í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ë§Œ ë Œë”ë§ë˜ì–´ì•¼í•œë‹¤. ê·¸ëŸ¬ë‚˜ í´ë¦­í•œ ì»´í¬ë„ŒíŠ¸ ì™¸ì—ë„ ë Œë”ë§ ëœë‹¤.

ğŸ’ **ìì„¸íˆ ì„¤ëª…í•´ë³´ì**

1ï¸âƒ£ **ì½œë°± í•¨ìˆ˜ì˜ ë³€ê²½**: App ì»´í¬ë„ŒíŠ¸ì—ì„œ ìƒíƒœ ë³€ê²½ í•¨ìˆ˜ë¥¼ ì •ì˜í•  ë•Œë§ˆë‹¤, ë§¤ ë Œë”ë§ë§ˆë‹¤ ìƒˆë¡œìš´ ì½œë°± í•¨ìˆ˜ê°€ ìƒì„±ë©ë‹ˆë‹¤. ì´ ì½œë°± í•¨ìˆ˜ëŠ” ë§¤ ë Œë”ë§ë§ˆë‹¤ ë‹¤ë¥¸ ì°¸ì¡°ê°’ì„ ê°€ì§€ë¯€ë¡œ, ChildComponentì˜ propsë¡œ ì „ë‹¬ë˜ëŠ” ê°’ì´ ë‹¬ë¼ì§„ ê²ƒìœ¼ë¡œ ì¸ì‹ë˜ì–´ ì „ì²´ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ëœë‹¤.
2ï¸âƒ£ **ìµœì í™”ë¥¼ ìœ„í•œ useMemo ë¯¸ì ìš©**: ì½œë°± í•¨ìˆ˜ë¥¼ useMemoë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ì´ì œì´ì…˜í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—, ë§¤ ë Œë”ë§ë§ˆë‹¤ ìƒˆë¡œìš´ ì½œë°± í•¨ìˆ˜ê°€ ìƒì„±ëœë‹¤.
3ï¸âƒ£ **ë Œë”ë§ íŠ¸ë¦¬ì˜ ê¹Šì´**: App ì»´í¬ë„ŒíŠ¸ê°€ ë‘ ê°œì˜ ChildComponentë¥¼ ë Œë”ë§í•˜ê³  ìˆìœ¼ë¯€ë¡œ, ìƒíƒœ ë³€ê²½ì´ ë°œìƒí•˜ë©´ ë‘ ê°œì˜ ChildComponent ëª¨ë‘ê°€ ë Œë”ë§ëœë‹¤.

## ê¸°ë³¸êµ¬ì¡°

**1ï¸âƒ£ ì²« ë²ˆì§¸ ì¸ìˆ˜** : í•¨ìˆ˜
**2ï¸âƒ£ ë‘ ë²ˆì§¸ ì¸ìˆ˜** : ì˜ì¡´ì„± ë°°ì—´

```jsx
const ChildComponent = memo(({ name , value , onChange})) => {
// ë Œë”ë§ ìˆ˜í–‰ í™•ì¸ìš©
    useEffect(() => {
        console.log('ë Œë”ë§!',name)
    })

    return (
        <>
          <h1>{name} {value ? 'ì¼œì§' ? 'êº¼ì§'}</h1>
          <button onClick = {onChange}>toggle</button>
        </>
    )
}

function App() {
    const [state1,setState1] = useState(false)
    const [state2,setState2] = useState(false)

 //const toggle1 = useCallback(()=>{
	//	    setStatus1(!status1)
	//    },
	//    [status1]
  //  )

    const toggle1 = useCallback(
	    function toggle1(){
		    setStatus1(!status1)
	    },
	    [status1]
    )

     const toggle2 = useCallback(
	    function toggle2(){
		    setStatus2(!status2)
	    },
	    [status2]
    )

    return (
        <>
          <ChildComponent name = "1" value = {state1} onChange = {toggle1} />
          <ChildComponent name = "2" value = {state2} onChange = {toggle2} />
        </>
    )
}

```

useCallbackì„ ì¶”ê°€í•˜ë©´ í•´ë‹¹ ì˜ì¡´ì„±ì´ ë³€ê²½ëì„ ë•Œë§Œ í•¨ìˆ˜ê°€ ì¬ìƒì„±ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

### **âœ” Q1. ì™œ ê¸°ëª…í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?**

> ë””ë²„ê¹…ì„ ìš©ì´í•˜ê¸° ìœ„í•¨, ìµëª…í•¨ìˆ˜ëŠ” ì´ë¦„ì´ ì—†ì–´ì„œ ì¶”ì í•˜ê¸° ì–´ë µë‹¤.

### **Q2. useMemoì™€ useCallbackì´ ê¸°ëŠ¥ì´ ë™ì¼í•˜ë‹¤ë©´ useMemoë¡œ useCallbackì„ êµ¬í˜„ ê°€ëŠ¥í•œê°€? â­•**

1ï¸âƒ£ ë‘˜ì˜ ìœ ì¼í•œ ì°¨ì´ëŠ” ëŒ€ìƒì´ **ë³€ìˆ˜ëƒ í•¨ìˆ˜ëƒ**ì¼ ë¿ì´ë‹¤
2ï¸âƒ£ ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œëŠ” í•¨ìˆ˜ ë˜í•œ **ê°’**ìœ¼ë¡œ í‘œí˜„ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ëŸ¬í•œ ì½”ë“œëŠ” ë§¤ìš° ìì—°ìŠ¤ëŸ½ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤
3ï¸âƒ£ ë‹¤ë§Œ useMemoë¡œ useCallbackì„ êµ¬í˜„í•˜ëŠ” ê²½ìš° ì½”ë“œê°€ **ë¶ˆí•„ìš”í•˜ê²Œ ê¸¸ì–´ì§€ê³  í˜¼ë™**ì„ ì•¼ê¸°í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë¦¬ì•¡íŠ¸ì—ì„œ ë³„ë„ë¡œ ì œê³µí•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶”ì¸¡í•´ ë³¼ ìˆ˜ ìˆë‹¤

# 3.1.5 useRef

**useState**ì™€ ë™ì¼í•˜ê²Œ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ ë Œë”ë§ì´ ë°œìƒí•´ë„ **ë³€ê²½ ê°€ëŠ¥í•œ ìƒíƒœê°’**ì„ ì§€ë‹Œë‹¤.
ê·¸ëŸ¬ë‚˜ useStateì™€ ë‘ê°€ì§€ì˜ ì°¨ì´ê°€ ìˆë‹¤.

1ï¸âƒ£ useRefëŠ” ë°˜í™˜ê°’ì¸ ê°ì²´ ë‚´ë¶€ì— ìˆëŠ” currentë¡œ ê°’ì— ì ‘ê·¼,ë³€ê²½ì´ ê°€ëŠ¥í•˜ë‹¤.
2ï¸âƒ£ useRefëŠ” ê°’ì´ ë³€í•´ë„ ë Œë”ë§ì„ ë°œìƒì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤

### **âœ” Q1. ë Œë”ë§ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šìœ¼ë©´ ê·¸ëƒ¥ í•¨ìˆ˜ ì™¸ë¶€ì—ì„œ ê°’ì„ ì„ ì–¸í•˜ê³  ê´€ë¦¬í•˜ëŠ” ê²Œ ì¢‹ì§€ ì•Šì„ê¹Œ?**

```jsx
let value = 0;
function MyComponent() {
  return <>{value}</>;
}
```

ì´ ë°©ì‹ì€ í¬ê²Œ ë‹¤ìŒê³¼ ê°™ì€ **ë‹¨ì **ì´ ìˆë‹¤.

ğŸš« ì»´í¬ë„ŒíŠ¸ê°€ ì‹¤í–‰ë˜ì–´ ë Œë”ë§ë˜ì§€ ì•Šì•„ë„ **valueë¼ëŠ” ê°’**ì´ ì¡´ì¬í•œë‹¤. ë©”ëª¨ë¦¬ì— ë¶ˆí•„ìš”í•œ ê°’ì„ ê°–ê²Œ í•˜ëŠ” ë¶€ì‘ìš©ì´ ìˆë‹¤.

> ì¼ë‹¨ í•¨ìˆ˜ ì™¸ë¶€ì—ì„œ ê°’ì„ ì„ ì–¸í•˜ë©´ ê·¸ ê°’ì€ í•­ìƒ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•œë‹¤.
> ì´ê²Œ ì–´ë–¤ ëœ»ì´ëƒë©´, ì»´í“¨í„°ê°€ ì‘ì—…ì„ í•  ë•ŒëŠ” ë©”ëª¨ë¦¬ì— ë°ì´í„°ë¥¼ ì˜¬ë ¤ë†“ê³  ì‘ì—…í•˜ëŠ”ë°,
> ê·¸ ë°ì´í„°ê°€ í•„ìš” ì—†ì–´ì ¸ë„ ê³„ì† ë©”ëª¨ë¦¬ì— ë‚¨ì•„ìˆê²Œ ëœë‹¤.
> ì´ëŸ¬í•œ ìƒí™©ì´ ë°˜ë³µë˜ë©´ ë©”ëª¨ë¦¬ê°€ ë‚­ë¹„ë˜ëŠ”ë°, ì´ê²ƒì„ "ë©”ëª¨ë¦¬ ëˆ„ìˆ˜"ë¼ê³  í•œë‹¤.
> ê·¸ë˜ì„œ ìš°ë¦¬ëŠ” ë Œë”ë§ê³¼ ìƒê´€ ì—†ëŠ” ê°’ì„ useRefë¡œ ë‹¤ë£¨ë©´ ì´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë§‰ì„ ìˆ˜ ìˆë‹¤.

ğŸš« ì»´í¬ë„ŒíŠ¸ê°€ ì—¬ëŸ¬ë²ˆ ìƒì„±ëœë‹¤ë©´ ê° ì»´í¬ë„ŒíŠ¸ì—ì„œ ëª¨ë‘ ë™ì¼í•œ valueë¥¼ ë°”ë¼ë³´ê²Œ ëœë‹¤.

> ì´ ì½”ë“œì—ì„œ `value`ëŠ” í•¨ìˆ˜ ì™¸ë¶€ì— ì„ ì–¸ë˜ì—ˆê¸° ë•Œë¬¸ì— ì»´í¬ë„ŒíŠ¸ê°€ ëª‡ ë²ˆ ë Œë”ë§ë˜ë”ë¼ë„ í•­ìƒ ê°™ì€ ê°’ì„ ë°”ë¼ë³´ê²Œ ëœë‹¤.ì´ ë§ì€ ì¦‰, `MyComponent`ë¥¼ ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•˜ë”ë¼ë„ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ê°€ ê°™ì€ `value`ë¥¼ ê³µìœ í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
> ë”°ë¼ì„œ `MyComponent`ê°€ ì—¬ëŸ¬ ë²ˆ ë Œë”ë§ë˜ì–´ë„ í™”ë©´ì— í‘œì‹œë˜ëŠ” ê°’ì€ í•­ìƒ ë™ì¼í•˜ë‹¤.

### **âœ” Q2. useRefëŠ” ì–¸ì œ ì‚¬ìš©í•˜ëŠ”ê°€**

âœ… ê°€ì¥ ì¼ë°˜ì ì¸ ì‚¬ìš© ì˜ˆëŠ” ë°”ë¡œ DOMì— ì ‘ê·¼í•˜ê³  ì‹¶ì„ ë•Œ

```jsx
import { useRef, useEffect } from 'react';

function MyComponent() {
  const inputRef = useRef();

  // ë Œë”ë§ í›„ì— useEffectë¥¼ í†µí•´ inputRef.current ê°’ì„ í™•ì¸
  useEffect(() => {
    console.log(inputRef.current); // <input type="text">
  }, [inputRef]);

  // input ìš”ì†Œë¥¼ ë°˜í™˜í•˜ë©´ì„œ ref ì†ì„±ì— inputRefë¥¼ í• ë‹¹
  return <input ref={inputRef} type='text' />;
}
```

**useRefì˜ ìµœì´ˆ ê¸°ë³¸ê°’**ì€ return ë¬¸ì— ì •ì˜í•´ë‘” **DOM**ì´ ì•„ë‹Œ **useRef()ë¡œ ë„˜ê²¨ë°›ì€ ì¸ìˆ˜**ì´ë‹¤.

useRefê°€ ì„ ì–¸ëœ ë‹¹ì‹œì—ëŠ” ì•„ì§ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë˜ê¸° ì „ì´ë¼ returnìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ì˜ DOMì´ ë°˜í™˜ë˜ê¸° ì „ì´ë¯€ë¡œ **undefined**ë‹¤.

**[ ì¥ì ì„ í™œìš©í•´ useStateì˜ ì´ì „ ê°’ì„ ì €ì¥í•˜ëŠ” usePrevious() ê°™ì€ í›…ì„ êµ¬í˜„í•´ë³´ì ]**

```jsx
import { useState, useRef } from 'react';

function usePrevious(value) {
  const ref = useRef();

  useEffect(() => {
    ref.current = value;
  }, [value]);

  return ref.current;
}

function SomeComponent() {
  const [counter, setCounter] = useState(0);
  const previousCounter = usePrevious(counter);

  function handleClick() {
    setCounter((prev) => prev + 1);
  }

  // 0, undefined
  // 1, 0
  // 2, 1

  return (
    <button onClick={handleClick}>
      {counter} {previousCounter}
    </button>
  );
}
```

### âœ” **Q3.** ì–´ë–»ê²Œ ì´ì „ ìƒíƒœë¥¼ ì¶”ì í•˜ë‚˜ìš”?

ì´ì „ ìƒíƒœëŠ” **useState**ë¥¼ í†µí•´ ê°±ì‹ ë˜ê³ , **useRef**ë¥¼ í†µí•´ ë³€ìˆ˜ì— ì €ì¥ë˜ì–´ ì¶”ì ë©ë‹ˆë‹¤

> ê°œë°œìê°€ ì›í•˜ëŠ” ì‹œì ì˜ ê°’ì„ ë Œë”ë§ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šê³  ë³´ê´€í•´ ë‘ê³  ì‹¶ë‹¤ë©´, useRefë¥¼ ì‚¬ìš©í•˜ì.

PreactëŠ” useRefì„ useMemoë¡œ êµ¬í˜„í•œë‹¤.
ë Œë”ë§ì— ì˜í–¥ì„ ë¯¸ì¹˜ë©´ ì•ˆë˜ê¸° ë–„ë¬¸ì— useMemoì— **ë¹ˆ ë°°ì—´**ì„ ë‘ê³ , ê° ë Œë”ë§ë§ˆë‹¤ ë™ì¼í•œ ê°ì²´ë¥¼ ë°”ë¼ë³´ê²Œ ëœë‹¤.

```jsx
export function useRef(initalValue) {
  currentHook = 5;
  return useMemo(() => {
    current: initalValue;
  }, []);
}
```

ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ íŠ¹ì§•, ê°ì²´ì˜ ê°’ì„ ë³€ê²½í•´ë„ ê°ì²´ë¥¼ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ë– ì˜¬ë¦¬ë©´ useMemoë¡œ useRefë¥¼ êµ¬í˜„í•  ìˆ˜ ë„ ìˆë‹¤

# 3.1.6 useContext

> useContextì— ëŒ€í•´ ì´í•´í•˜ë ¤ë©´ ë¨¼ì € ë¦¬ì•¡íŠ¸ **context**ì— ëŒ€í•´ ì•Œì•„ì•¼í•œë‹¤.

## 1. contextë€?

ë¦¬ì•¡íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ì™€ ìì‹ ì»´í¬ë„ŒíŠ¸ë¡œ ì´ë£¨ì–´ì§„ íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ê°–ê¸° ë–„ë¬¸ì— ë¶€ëª¨ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ propsë¡œ ë°ì´í„°ë¥¼ ë„˜ê²¨ì¤€ë‹¤. ê·¸ëŸ¬ë‚˜ ì „ë‹¬í•´ì•¼í•˜ëŠ” ë¶€ëª¨-ìì‹ì˜ ê¹Šì´ê°€ ê¹Šì–´ì§€ë©´ ğŸš«**props drilling**ğŸš« í˜„ìƒì´ ë°œìƒí•œë‹¤.

> ì½˜í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ëª…ì‹œì ì¸ props ì „ë‹¬ ì—†ì´ë„ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ ì „ë¶€ì—ì„œ ì›í•˜ëŠ” ê°’ì„ ììœ ë¡­ê²Œ ì“¸ ìˆ˜ ìˆë‹¤.

```jsx
const Context = (createContext < { hello: string }) | (undefined > undefined);

function ParentComponent() {
  return (
    <Context.Provider value={{ hello: 'react' }}>
      <Context.Provider value={{ hello: 'js' }}>
        <ChildComponent />
      </Context.Provider>
    </Context.Provider>
  );
}

function ChildComponent() {
  const value = useContext(Context);
  // Reactê°€ ì•„ë‹Œ jsê°€ ë°˜í™˜ëœë‹¤.
  return <>{value ? value.hello : ''}</>;
}
```

useContextë¥¼ ì‚¬ìš©í•˜ë©´ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ ì–´ë”˜ê°€ì— ì„ ì–¸ëœ **<Context.Provider>**ì˜ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤. useContext ë‚´ë¶€ì—ì„œ **í•´ë‹¹ ì½˜í…ìŠ¤íŠ¸ê°€ ì¡´ì¬í•˜ëŠ” í™˜ê²½**ì¸ì§€ , **ì´ˆê¸°í™” ë˜ì–´ ê°’**ì„ ë‚´ë ¤ì£¼ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

```jsx
import { createContext, useContext, PropsWithChildren } from 'react';

// ì»¨í…ìŠ¤íŠ¸ ìƒì„±
const MyContext = (createContext < { hello: string }) | (undefined > undefined);

// ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ëŠ” Provider ì»´í¬ë„ŒíŠ¸
function ContextProvider({ children, text }: PropsWithChildren<{ text: string }>) {
  // Provider ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ì»¨í…ìŠ¤íŠ¸ ê°’ ì„¤ì •
  return <MyContext.Provider value={{ hello: text }}>{children}</MyContext.Provider>;
}

// ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” í›…
function useMyContext() {
  // ì»¨í…ìŠ¤íŠ¸ ê°’ ê°€ì ¸ì˜¤ê¸°
  const context = useContext(MyContext);
  // ì»¨í…ìŠ¤íŠ¸ ê°’ì´ undefinedì¸ ê²½ìš° ì—ëŸ¬ ì²˜ë¦¬
  if (context === undefined) {
    throw new Error('useMyContextëŠ” ContextProvider ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
  }
  return context;
}

// ì»¨í…ìŠ¤íŠ¸ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ìì‹ ì»´í¬ë„ŒíŠ¸
function ChildComponent() {
  // ì»¨í…ìŠ¤íŠ¸ í›…ì„ ì‚¬ìš©í•˜ì—¬ ê°’ ê°€ì ¸ì˜¤ê¸°
  const { hello } = useMyContext();
  return <>{hello}</>;
}

// ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ëŠ” ì˜ˆì‹œ
function ParentComponent() {
  return (
    <ContextProvider text='react'>
      <ChildComponent />
    </ContextProvider>
  );
}
```

- `createContext` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë§Œë“ ë‹¤.
- ì´ ì»¨í…ìŠ¤íŠ¸ëŠ” `{ hello: string }` íƒ€ì…ì˜ ê°ì²´ë¥¼ í¬í•¨í•˜ê±°ë‚˜ `undefined` ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. ì²˜ìŒì—ëŠ” `undefined`ë¡œ ì´ˆê¸°í™”ëœë‹¤.
- **ContextProvider** ì»´í¬ë„ŒíŠ¸ëŠ” `MyContext.Provider`ë¡œ ë‘˜ëŸ¬ì‹¸ì—¬ ìˆë‹¤. ì´ ProviderëŠ” í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë“¤ì—ê²Œ ì»¨í…ìŠ¤íŠ¸ ê°’ì„ ì œê³µí•œë‹¤. ì—¬ê¸°ì„œëŠ” `{ hello: text }`ë¥¼ ê°’ìœ¼ë¡œ ì œê³µí•˜ê³  ìˆë‹¤
- `useMyContext`ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì´ í•¨ìˆ˜ëŠ” í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ ê°’ì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ `useContext` í›…ì„ ì‚¬ìš©í•˜ë‹¤.
- `ChildComponent`ë¼ëŠ” í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ë¥¼ ì •ì˜í•œë‹¤. ì´ ì»´í¬ë„ŒíŠ¸ëŠ” í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ ê°’ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ `useMyContext` í›…ì„ í˜¸ì¶œí•œë‹¤.

## 2. useContext ì‚¬ìš©ì‹œ ì£¼ì˜ ì‚¬í•­

âœ… ì»´í¬ë„ŒíŠ¸ ì¬í™œìš©ì´ ì–´ë ¤ì›Œì§„ë‹¤.
: useContextê°€ ì„ ì–¸ë˜ì–´ìˆìœ¼ë©´ Providerì™€ ê°•í•œ ì˜ì¡´ì„±ì„ ê°–ê²Œ ëœë‹¤.

### âœ” Q1. ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œ ëª¨ë“  ì½˜í…ìŠ¤íŠ¸ë¥¼ ìµœìƒìœ„ ë£¨íŠ¸ ì»´í¬ë„ŒíŠ¸ì— ë„£ëŠ” ê²ƒì€ ì–´ë–¨ê¹Œ?

ì½˜í…ìŠ¤íŠ¸ê°€ ë§ì•„ì§ˆìˆ˜ë¡ ë£¨íŠ¸ ì»´í¬ë„ŒíŠ¸ëŠ” ë” ë§ì€ ì½˜í…ìŠ¤íŠ¸ë¡œ ë‘˜ëŸ¬ì‹¸ì¼ ê²ƒì´ë‹¤.
í•´ë‹¹ propsë¥¼ ë‹¤ìˆ˜ì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œë” í•´ì•¼í•˜ë¯€ë¡œ **ë¦¬ì†ŒìŠ¤ ë‚­ë¹„**ê°€ ìƒê¸´ë‹¤.

### âœ” Q2. useContextëŠ” ìƒíƒœê´€ë¦¬ë¥¼ ìœ„í•œ ë¦¬ì•¡íŠ¸ APIì¸ê°€? âŒ

**useContext**ëŠ” ìƒíƒœë¥¼ ì£¼ì…í•´ ì£¼ëŠ” APIë‹¤.
ì¼ë°˜ì ì¸ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë‹¤ìŒì„ ë§Œì¡±í•œë‹¤.
ê·¸ëŸ¬ë‚˜ ì½˜í…ìŠ¤íŠ¸ëŠ” ì´ ë‘˜ ì¤‘ ì•„ë¬´ê²ƒë„ í•˜ì§€ ëª»í•œë‹¤.

âœ… ì–´ë–¤ ìƒíƒœë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥¸ ìƒíƒœë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.
âœ… í•„ìš”ì— ë”°ë¼ ìƒíƒœ ë³€í™”ë¥¼ ìµœì í™”í•œë‹¤.

**ë‹¨ìˆœíˆ propsê°’ì„ í•˜ìœ„ë¡œ ì „ë‹¬í•´ ì¤„ ë¿**

```jsx
import { createContext, useContext, PropsWithChildren } from 'react';

// ì»¨í…ìŠ¤íŠ¸ ìƒì„±
const MyContext = createContext<{ hello: string } | undefined>(undefined);

// ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” í›…
function useMyContext() {
  // ì»¨í…ìŠ¤íŠ¸ ê°’ ê°€ì ¸ì˜¤ê¸°
  const context = useContext(MyContext);
  // ì»¨í…ìŠ¤íŠ¸ ê°’ì´ undefinedì¸ ê²½ìš° ì—ëŸ¬ ì²˜ë¦¬
  if (context === undefined) {
    throw new Error('useMyContextëŠ” ContextProvider ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
  }
  return context;
}

// ì»¨í…ìŠ¤íŠ¸ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ìì‹ ì»´í¬ë„ŒíŠ¸
function GrandChildComponent() {
  // ì»¨í…ìŠ¤íŠ¸ í›…ì„ ì‚¬ìš©í•˜ì—¬ ê°’ ê°€ì ¸ì˜¤ê¸°
  const { hello } = useMyContext();
  useEffect(()=>{
	  console.log('ë Œë”ë§ GCC')
  })
  return <>{hello}</>;
}

// ì»¨í…ìŠ¤íŠ¸ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ìì‹ ì»´í¬ë„ŒíŠ¸
function ChildComponent() {
 useEffect(()=>{
	  console.log('ë Œë”ë§ CC')
  })
  return <GrandChildComponent/>;
}

// ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ëŠ” ì˜ˆì‹œ
function ParentComponent() {
		const [text,setText]=useState('');

			function handleChange(e){
				setText(e.target.value)
			}

			 useEffect(()=>{
	  console.log('ë Œë”ë§ PC')
  })

  return (
    <ContextProvider text="react">
		  <input value={text} onChange={handleChange}
      <ChildComponent />
    </ContextProvider>
  );
}


```

âœ… `ParentComponent`ì—ì„œ Providerì˜ ê°’ì„ ë‚´ë ¤ì£¼ê³ , useContextë¡œ `GrandChildComponent`ì—ì„œ ì‚¬ìš© ì¤‘ì´ë‹¤.
âœ… ì–¸ëœ» ë³´ë©´ `ParentComponent`ì™€ `GrandChildComponent`ë§Œ ë Œë”ë§ ë  ê²ƒ ê°™ì§€ë§Œ âŒ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ì „ì²´ê°€ ë¦¬ë Œë”ë§ ë˜ê³  ìˆë‹¤.

### âœ” Q3. ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ ìµœì í™” í•´ì•¼í• ê¹Œ?

```jsx
const ChildComponent = memo(() => {
  useEffect(() => {
    console.log('ë Œë”ë§ CC');
  });
  return <GrandChildComponent />;
});
```

âœ… ChildComponentê°€ ë Œë”ë§ë˜ì§€ ì•Šê²Œ ë§‰ìœ¼ë ¤ë©´ **React.meo**ë¥¼ ì¨ì•¼í•œë‹¤.

# **3.1.7 useReducer**

> **useReducerëŠ” useStateì˜ ì‹¬í™”ë²„ì „**

```jsx
const [state, dispatch] = useReducer(StateReducer);
```

- ë°˜í™˜ê°’ì€ useStateì™€ ë™ì¼í•˜ê²Œ ê¸¸ì´ê°€ 2ì¸ ë°°ì—´
  - `state` : í˜„ì¬ useReducerê°€ ê°€ì§€ê³  ìˆëŠ” ê°’
  - `dispatcher` : stateë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
    - useStateì™€ ë‹¬ë¦¬ setStateëŠ” ë‹¨ìˆœíˆ ê°’ì„ ë„˜ê²¨ì£¼ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” **action**ì„ ë„˜ê²¨ì¤€ë‹¤
    - actionì€ **stateë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ì•¡ì…˜**ì„ ì˜ë¯¸í•œë‹¤.

```jsx
//ë¦¬ë“€ì„œ í•¨ìˆ˜ëŠ” 2ê°œì˜ ì¸ìˆ˜ë¥¼ ë°›ëŠ”ë‹¤. (ìƒíƒœì™€ ì•¡ì…˜)
function StateReducer(state, action) {
  //ì—…ë°ì´íŠ¸ ëœ ìƒíƒœë¥¼ ë°˜í™˜í•œë‹¤.
  return state;
}
```

- useStateì˜ ì¸ìˆ˜ì™€ ë‹¬ë¦¬ 2ê°œì—ì„œ 3ê°œì˜ ì¸ìˆ˜ë¥¼ í•„ìš”ë¡œ í•œë‹¤
  - `reducer` : ê¸°ë³¸ actionì„ ì •ì˜í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤. ì²«ë²ˆì§¸ ì¸ìˆ˜ë¡œ ë„˜ê²¨ì•¼ í•œë‹¤.
  - `initalState` : ë‘ë²ˆì¨° ì¸ìˆ˜ë¡œ useReducerì˜ ì´ˆê¸° ê°’ì´ë‹¤.
  - `init(ì„ íƒ)`: ì´ˆê¸°ê°’ì„ ì§€ì—°í•´ì„œ ìƒì„±í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜.

## **useReducerì˜ ì‚¬ìš©ë²•**

```jsx
// â‘  useReducerê°€ ì‚¬ìš©í•  stateë¥¼ ì •ì˜
type State = {
  count: number,
};

// â‘¡ stateì˜ ë³€í™”ë¥¼ ë°œìƒì‹œí‚¬ actionì˜ íƒ€ì…ê³¼ ë„˜ê²¨ì¤„ ê°’(payload)ì„ ì •ì˜
type Action = { type: 'up' | 'down' | 'reset', payload?: State };

// â‘¢ ì´ˆê¸° ìƒíƒœë¥¼ ì •ì˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” í˜„ì¬ ìƒíƒœë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ëŠ” ê¸°ë³¸ ì´ˆê¸°í™” í•¨ìˆ˜
function init(count: State): State {
  // countë¥¼ ë°›ì•„ì„œ ì´ˆê¹ƒê°’ì„ ì–´ë–»ê²Œ ì •ì˜í• ì§€ ì—°ì‚°í•˜ë©´ ëœë‹¤.
  return count;
}

// ì´ˆê¹ƒê°’
const initialState: State = { count: 0 };

// â‘£ ì•ì„œ ì„ ì–¸í•œ stateì™€ actionì„ ê¸°ë°˜ìœ¼ë¡œ stateê°€ ì–´ë–»ê²Œ ë³€ê²½ë ì§€ ì •ì˜
function reducer(state: State, action: Action): State {
  switch (action.type) {
    case 'up':
      return { count: state.count + 1 };
    case 'down':
      return { count: state.count - 1 > 0 ? state.count - 1 : 0 };
    case 'reset':
      return int(action.payload || { count: 0 });
    default:
      throw new Error(`Unexpected action type ${action.type}`);
  }
}

export default function App() {
  // â‘¤ useReducer í›…ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ë“€ì„œ í•¨ìˆ˜, ì´ˆê¸° ìƒíƒœ, ì´ˆê¸°í™” í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ìƒíƒœì™€ ë””ìŠ¤íŒ¨ì²˜ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
  const [state, dispatch] = useReducer(reducer, initialState, init);
  // â‘¥ ê° ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ì—ì„œëŠ” í•´ë‹¹ ì•¡ì…˜ì„ ë””ìŠ¤íŒ¨ì¹˜í•˜ì—¬ ìƒíƒœë¥¼ ë³€ê²½
  function handleUpButtonClick() {
    dispatch({ type: 'up' });
  }

  function handleDownButtonClick() {
    dispatch({ type: 'down' });
  }

  function handleResetButtonClick() {
    dispatch({ type: 'reset', payload: { count: 1 } });
  }

  return (
    <div className='App'>
      <h1>{state.count}</h1>
      <button onClick={handleUpButtonClick}>+</button>
      <button onClick={handleDownButtonClick}>-</button>
      <button onClick={handleResetButtonClick}>reset</button>
    </div>
  );
}
```

**payload** : ì•¡ì…˜ì— ë”°ë¼ ì¶”ê°€ì ì¸ ì •ë³´ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆëŠ”ë°, ì—¬ê¸°ì„œëŠ” ìƒˆë¡œìš´ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” **`State`** ê°ì²´ë¥¼ ë°›ìŠµë‹ˆë‹¤.

ğŸ’¡ **useReducerì˜ ëª©ì **ì€,
ë³µì¡í•œ í˜•íƒœì˜ `state`ë¥¼ ì‚¬ì „ì— ì •ì˜ëœ `dispatcher`ë¡œë§Œ ìˆ˜ì •í•  ìˆ˜ìˆê²Œ ë§Œë“¤ì–´ ì¤Œìœ¼ë¡œì¨ **stateê°’ì— ëŒ€í•œ ì ‘ê·¼ì€ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ê°€ëŠ¥**í•˜ê²Œ í•˜ê³ ,
ì´ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ `ìƒì„¸ ì •ì˜`ëŠ” **ì»´í¬ë„ŒíŠ¸ ë°–ì—ë‹¤ ë‘” ë‹¤ìŒ**,
stateì˜ ì—…ë°ì´íŠ¸ë¥¼ **ë¯¸ë¦¬ ì •ì˜í•´ ë‘” dispatcherë¡œë§Œ ì œí•œ**í•˜ëŠ” ê²ƒì´ë‹¤.

> ì¼ë°˜ì ìœ¼ë¡œ ë‹¨ìˆœíˆ numberë‚˜ booleanê³¼ ê°™ì´ ê°„ë‹¨í•œ ê°’ì„ ê´€ë¦¬í•˜ëŠ” ê²ƒì€
> useStateë¡œ ì¶©ë¶„í•˜ì§€ë§Œ state í•˜ë‚˜ê°€ ê°€ì ¸ì•¼ í•  ê°’ì´ ë³µì¡í•˜ê³  ì´ë¥¼ ìˆ˜ì •í•˜ëŠ” ê²½ìš°ì˜ ìˆ˜ê°€
> ë§ì•„ì§„ë‹¤ë©´ stateë¥¼ ë¬¶ì–´ useReducerë¡œ ê´€ë¦¬í•˜ëŠ” í¸ì´ ë” íš¨ìœ¨ì ì¼ ìˆ˜ë„ ìˆë‹¤.

Preactì˜ useStateëŠ” useReducerë¡œ êµ¬í˜„ë˜ì–´ ìˆë‹¤.

```jsx
export function useState(initalState) {
  currentHook = 1;
  return useReducer(invokeOrReturn, initalState);
}
```

âœ… ì²«ë²ˆì¨° ì¸ìˆ˜ëŠ” ê°’ì„ **ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜**ì´ê±°ë‚˜ **ê°’ ê·¸ ìì²´**ì—¬ì•¼ í•œë‹¤.

```jsx
function reducer(prevState, newState) {
  return typeof newState === 'function' ? newState(prevState) : newState;
}
```

âœ… ë‘ë²ˆì¨° ê°’ì€ ë³„ë‹¤ë¥¸ ì²˜ë¦¬ê°€ ì—†ê³ , ì„¸ë²ˆì§¸ ì¸ìˆ˜ëŠ” ë‘ë²ˆì§¸ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ê²Œìœ¼ë¥¸ ì´ˆê¸°í™”ë¥¼ í•œë‹¤.

```jsx
function init(initArg: Initalizer) {
  return typeof initArg === 'function' ? initArg() : initArg;
}
```

ìœ„ ë‘ í•¨ìˆ˜ë¥¼ ëª¨ë‘ useReducerì—ì„œ ì‚¬ìš©í•˜ë©´ useStateì˜ ì‘ë™ì„ í‰ë‚´ ë‚¼ ìˆ˜ ìˆë‹¤.

# **3.1.8 useImperativeHandle**

useImperativeHandleì€ ìì£¼ ë³¼ ìˆ˜ ì—†ëŠ” í›…ì´ë‹¤.

ì´ê²ƒì„ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” ë¨¼ì € **react.forwardRef**ì— ëŒ€í•´ ì•Œì•„ì•¼í•œë‹¤.

forwardRefëŠ” useRefì—ì„œ ë°˜í™˜í•˜ëŠ” ê°ì²´ë¡œ, ë¦¬ì•¡íŠ¸ì˜ propsì¸ refë¥¼ ë„£ì–´ HTMLElementì— ì ‘ê·¼í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ëœë‹¤.

```jsx
const ChildComponent = forwardRef({ref} => {
    useEffect(() => {
    //undefined
      console.log(ref)
    },[ref])

    return <div>ì•ˆë…•</div>
})

const ParentComponent = () => {
    const inputRef = useRef()

    return (
    <input ref = {inputRef} />
    <ChildComponent ref = {inputRef} />

    )
}

```

ë¦¬ì•¡íŠ¸ì—ì„œ refëŠ” propsë¡œ ì“¸ ìˆ˜ ì—†ë‹¤ëŠ” ê²½ê³ ë¬¸ê³¼ í•¨ê»˜ ì ‘ê·¼ì„ ì‹œë„í•  ê²½ìš°,
â¡ undefinedë¥¼ ë°˜í™˜í•œë‹¤ê³  ë¼ ìˆë‹¤.

### âœ” Q1. ê·¸ë ‡ë‹¤ë©´ ì˜ˆì•½ì–´ë¡œ ì§€ì •ëœ ref ëŒ€ì‹  ë‹¤ë¥¸ propsë¡œ ë°›ìœ¼ë©´ ì–´ë–¨ê¹Œ?

```jsx
const ChildComponent=(parentRef) => {
    useEffect(() => {
    // {current: undefined}
    // {current: HTMLInputElement}
      console.log(parentRef)
    },[parentRef])

    return <div>ì•ˆë…•</div>
})

const ParentComponent = () => {
    const inputRef = useRef()

    return (
    <input ref={inputRef} />
    <ChildComponent parentRef={inputRef} />

    )
}

```

ì´ëŸ¬í•œ ë°©ì‹ì€ ì•ì„  ì˜ˆì œì™€ ë‹¤ë¥´ê²Œ ì˜ ì‘ë™í•œë‹¤.

> forwardRefëŠ” ë°©ê¸ˆ ì‘ì„±í•œ ì½”ë“œì™€ ë™ì¼í•œ ì‘ì—…ì„ í•˜ëŠ” ë¦¬ì•¡íŠ¸ APIë‹¤.

### âœ” Q2. ê·¸ëŸ°ë° ì´ë ‡ê²Œ propsë¡œ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ê²ƒì„ ì™œ ë§Œë“œëŠ”ê±´ê°€?

> propsë¥¼ í†µí•´ì„œ ì„ ì–¸í˜• ë°ì´í„°ë§Œìœ¼ë¡œëŠ” ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ ë™ì‘ì„ êµ¬í˜„í•˜ê¸° ì–´ë ¤ìš´ ê²½ìš°ê°€ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì—¬ê¸°ì„œ ì–´ë µë‹¤ê³  í‘œí˜„í•œ ì´ìœ ëŠ”, ëŒ€ë¶€ë¶„ì˜ ê²½ìš° propsì™€ useEffect ë“±ì„ í†µí•´ì„œ ë¶ˆí¸í•˜ì§€ë§Œ ì˜ë„í•œ ë™ì‘ì„ ë§Œë“¤ ìˆ˜ëŠ” ìˆê¸° ë•Œë¬¸ì´ë‹¤.
> ê·¸ëŸ¬ë‚˜ ëª…ë ¹í˜• í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ì´ëŸ° êµ¬í˜„ì´ í›¨ì”¬ ê°„ë‹¨í•´ì§ˆ ìˆ˜ ìˆë‹¤.

```jsx
const ChildComponent = forwardRef((props,ref) => {
    useEffect(() => {
    // {current: undefined}
    // {current: HTMLInputElement}
      console.log(ref)
    },[ref])

    return <div>ì•ˆë…•</div>
})

const ParentComponent = () => {
    const inputRef = useRef()

    return (
    <input ref={inputRef} />
    <ChildComponent ref={inputRef} />

    )
}

```

refë¥¼ë°›ê³ ìí•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ forwardRefë¡œ ê°ì‹¸ê³  ë‘ë²ˆì¨° ì¸ìˆ˜ë¡œ refë¥¼ ì „ë‹¬ë°›ëŠ”ë‹¤.
ì´ì œ ë¶€ëª¨ì—ì„œ ìì‹ìœ¼ë¡œ refë¥¼ ë„˜ê²¨ì£¼ë©´ ëœë‹¤.
ì´ë ‡ê²Œ forwardRefë¥¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œë¡œ ìˆ˜ì •í•˜ë©´ refë¥¼ propsë¡œ ì „ë‹¬ í•  ìˆ˜ ìˆê³ , ì „ë‹¬ ë°›ì€ ì»´í¬ë„ŒíŠ¸ì—ì„œë„ refë¼ëŠ” ì´ë¦„ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## **useImperativeHandleë€?**

> useImperativeHandle í›…ì€ ë¶€ëª¨ì—ì„œ ë„˜ê²¨ë°›ì€ refë¥¼ ì›í•˜ëŠ” ëŒ€ë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” í›…ì´ë‹¤.

ì´ í›…ì€ ì£¼ë¡œ ë¦¬ì•¡íŠ¸ì˜ ref ì‹œìŠ¤í…œê³¼ í•¨ê»˜ ì‚¬ìš©ë˜ë©°, ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¡œ ë…¸ì¶œí•´ì•¼ í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì„¸ë°€í•˜ê²Œ ì œì–´í•  ë•Œ ìœ ìš©í•˜ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ, ì´ í›…ì€ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ ë©”ì„œë“œë‚˜ ì†ì„±ì„ ì •ì˜í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤

ìš°ë¦¬ëŠ” ìì‹ ì»´í¬ë„ŒíŠ¸ì¸ `ChildComponent`ê°€ ìŠ¤í¬ë¡¤ì„ ì¡°ì‘í•˜ëŠ” ê¸°ëŠ¥ì„ ê°–ì¶”ê³  ìˆë‹¤ê³  í•œë‹¤. ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ì´ ìŠ¤í¬ë¡¤ì„ ìì‹ ì»´í¬ë„ŒíŠ¸ë¥¼ í†µí•´ ì œì–´í•˜ê³  ì‹¶ì–´í•œë‹¤.

```jsx
// ChildComponent.js

import React, { useRef, useImperativeHandle, forwardRef } from 'react';

const ChildComponent = forwardRef((props, ref) => {
  const containerRef = useRef(null);

  // useImperativeHandleì„ ì‚¬ìš©í•˜ì—¬ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ë…¸ì¶œí•  ë©”ì„œë“œë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
  useImperativeHandle(ref, () => ({
    // ì™¸ë¶€ì—ì„œ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” ìŠ¤í¬ë¡¤ ì¡°ì‘ ë©”ì„œë“œë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
    scrollToTop: () => {
      containerRef.current.scrollTop = 0;
    },
    // ë‹¤ë¥¸ ë…¸ì¶œí•  ë©”ì„œë“œë“¤ë„ ì—¬ê¸°ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  }));

  return (
    <div ref={containerRef} style={{ overflowY: 'scroll', height: '200px', border: '1px solid black' }}>
      {props.children}
    </div>
  );
});

export default ChildComponent;
```

ìœ„ì˜ ì½”ë“œì—ì„œ, `useImperativeHandle`ì„ ì‚¬ìš©í•˜ì—¬ `scrollToTop`ì´ë¼ëŠ” ë©”ì„œë“œë¥¼ ì •ì˜í–ˆë‹¤. ì´ ë©”ì„œë“œëŠ” ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ ìŠ¤í¬ë¡¤ì„ ë§¨ ìœ„ë¡œ ì´ë™ì‹œí‚¬ ë•Œ ì‚¬ìš©

ì´ì œ ì´ **`scrollToTop`** ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚´í´ë³´ì

```jsx
// ParentComponent.js

import React, { useRef } from 'react';
import ChildComponent from './ChildComponent';

const ParentComponent = () => {
  const childRef = useRef(null);

  const handleClick = () => {
    // ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ scrollToTop ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ìŠ¤í¬ë¡¤ì„ ë§¨ ìœ„ë¡œ ì´ë™ì‹œí‚µë‹ˆë‹¤.
    childRef.current.scrollToTop();
  };

  return (
    <div>
      <button onClick={handleClick}>ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤</button>
      <ChildComponent ref={childRef}>
        {/* ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ ë‚´ìš©ì„ ì—¬ê¸°ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. */}
      </ChildComponent>
    </div>
  );
};

export default ParentComponent;
```

ìœ„ì˜ ì½”ë“œì—ì„œ `ChildComponent`ë¥¼ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë Œë”ë§í•˜ê³ , ê·¸ ì•„ë˜ì—ëŠ” "ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤"ì´ë¼ëŠ” ë²„íŠ¼ì„ ë Œë”ë§í•œë‹¤. ì´ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ `ChildComponent`ì˜ ìŠ¤í¬ë¡¤ì´ ë§¨ ìœ„ë¡œ ì´ë™í•˜ë„ë¡ ë§Œë“¤ì—ˆë‹¤.

ì´ê²ƒì´ `useImperativeHandle`ì˜ ê°„ë‹¨í•œ ì˜ˆì‹œì´ë‹¤. ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ê²Œ ë…¸ì¶œí•˜ëŠ” ë©”ì„œë“œë¥¼ ì •ì˜í•˜ì—¬ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•´ë‹¹ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì´ë‹¤.

# **3.1.9 useLayoutEffect**

> ì´ í›…ì€ useEffectì™€ í›…ì˜ í˜•íƒœë‚˜ ì‚¬ìš© ì˜ˆì œê°€ ë™ì¼í•˜ë‹¤. ë³´í†µ ë¸Œë¼ìš°ì € í˜ì¸íŠ¸ ì „ DOM ì¡°ì‘, í˜¹ì€ ë ˆì´ì•„ì›ƒ ì •ë³´ë¥¼ ì½ì–´ì•¼ í•  ë•Œ ì‚¬ìš©í•œë‹¤.

```jsx
function App() {
  const [count, setCount] = useState(0);

  useEffect(() => {
    console.log('useEffect' + count);
  }, [count]);

  useLayoutEffect(() => {
    console.log('useLayoutEffect' + count);
  }, [count]);

  function handleClick() {
    setCount((prev) => prev + 1);
  }

  return (
    <>
      <h1>{count}</h1>
      <button onClick={handleClick}>+</button>
    </>
  );
}
```

ì´ í›…ì—ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ì€ ëª¨ë“  **DOMì˜ ë³€ê²½ í›„**ì— useLayoutEffectì˜ ì½œë°±ì´ ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤ëŠ” ì ì´ë‹¤.
âœ…ì—¬ê¸°ì„œ ë§í•˜ëŠ” **DOMë³€ê²½**ì´ë€ ë Œë”ë§ì´ì§€, ë¸Œë¼ìš°ì €ì— ì‹¤ì œë¡œ **í•´ë‹¹ ë³€ê²½ ì‚¬í•­ì´ ë°˜ì˜ë˜ëŠ” ì‹œì **ì„ ì˜ë¯¸í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

[ **useLayoutEffect** ë™ì‘ ê³¼ì •]
![](https://velog.velcdn.com/images/juhee067/post/2e8590a8-86dc-4900-b84e-8aa1f6d27894/image.png)

ì‹¤í–‰ ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤

- ë¦¬ì•¡íŠ¸ê°€ DOMì„ ì—…ë°ì´íŠ¸
- useLayoutEffectì‹¤í–‰
- ë¸Œë¼ìš°ì €ì— ë³€ê²½ì‚¬í•­ ë°˜ì˜
- useEffectì‹¤í–‰

âœ… ìˆœì„œ ìƒìœ¼ë¡œëŠ” useEffectê°€ ë¨¼ì € ì„ ì–¸ë¼ ìˆì§€ë§Œ í•­ìƒ useLayoutEffectê°€ ë¨¼ì € ì‹¤í–‰ëœë‹¤.

> useLayoutEffectê°€ ë¸Œë¼ìš°ì €ì— ë³€ê²½ ì‚¬í•­ì´ ë°˜ì˜ ë˜ê¸° ì „ì— ì‹¤í–‰ë˜ëŠ” ë°˜ë©´, useEffectëŠ” ë¸Œë¼ìš°ì €ì— ë³€ê²½ ì‚¬í•­ì´ ë°˜ì˜ëœ ì´í›„ì— ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì´ë‹¤.

ê·¼ë° ì´ëŸ¬í•œ ë°©ì‹ì€ **ë¬¸ì œ**â›”ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.(useLayoutEffectê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê¸° ë•Œë¬¸ì—)

### âœ” Q1. ê·¸ëŸ¼ ì–¸ì œ useLayoutEffectë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì„ê¹Œ?

âœ… useLayoutEffectì˜ íŠ¹ì§•ìƒ DOMì€ ê³„ì‚°ëì§€ë§Œ ì´ê²ƒì´ í™”ë©´ì— ë°˜ì˜ë˜ê¸° ì „ì— í•˜ê³  ì‹¶ì€ ì‘ì—…ì´ ìˆì„ ë•Œ

ex) íŠ¹ì •ìš”ì†Œì— ë”°ë¼ DOMìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì• ë‹ˆë©”ì´ì…˜, ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ ì œì–´í•˜ëŠ” ë“±

# **3.1.10 useDebugValue**

> ì¼ë°˜ì ìœ¼ë¡œ í”„ë¡œë•ì…˜ ì›¹ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ëŠ” í›…ì´ ì•„ë‹ˆë‹¤. ì‚¬ìš©ì ì •ì˜ í›… ë‚´ë¶€ì˜ ë‚´ìš©ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆëŠ” í›…ì´ë‹¤.

# **3.1.11 í›…ì˜ê·œì¹™**

### âœ” Q1. í›…ì—ëŠ” ê·œì¹™ì´ ìˆì„ê¹Œ? â­•

ì´ëŸ¬í•œ ê·œì¹™ì„ **rules-of-hooks**ë¼ê³  í•œë‹¤.

```jsx
function Component() {
  const [count, setCount] = useState(0);
  const [required, setRequired] = useState(false);

  useEffect(() => {}, [count, required]);
}
```

ì´ ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¡œ ì €ì¥ëœë‹¤.

```jsx
**{
    memorizedState:0,
    baseState:0,
    queue:{..},
    next:{ //setRequiredí›…
        memorizedState:false,
        next:{
            //useEffectí›…
            memorizedState : {

            }
        }
    }
}**

```

âœ… í›…ì€ ìµœìƒë‹¨ì—ì„œë§Œ í˜¸ì¶œí•´ì•¼ í•˜ê³ , ë°˜ë³µë¬¸, ì¡°ê±´ë¬¸ ë“±ì—ì„œ í›…ì„ í˜¸ì¶œí•  ìˆ˜ ì—†ë‹¤.
âœ… ì‚¬ìš©ì ì •ì˜ í›…, ë¦¬ì•¡íŠ¸ í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ í›…ì„ ì“¸ ìˆ˜ ìˆë‹¤.
âœ… í›…ì— ëŒ€í•œ ì •ë³´ëŠ” ë¦¬ì•¡íŠ¸ ì–´ë”˜ê°€ì˜ indexì™€ ê°™ì€ keyë¥¼ ê¸°ì¤€ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆë‹¤. ë˜í•œ ìˆœì„œì— í° ì˜í–¥ì„ ë°›ëŠ”ë‹¤.â¡ useStateë‚˜ useEffectì˜ ê²½ìš° ìˆœì„œì— ì•„ì£¼ í° ì˜í–¥ ë°›ìŒ
